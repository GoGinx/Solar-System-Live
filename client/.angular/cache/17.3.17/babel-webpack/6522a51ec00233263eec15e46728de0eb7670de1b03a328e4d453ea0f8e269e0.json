{"ast":null,"code":"import { interval, startWith, switchMap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/voyager.service\";\nimport * as i2 from \"../../services/time-scrubber.service\";\nimport * as i3 from \"@angular/common\";\nfunction VoyagerMapComponent__svg_circle_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelement(0, \"circle\", 14);\n  }\n  if (rf & 2) {\n    const r_r1 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵattribute(\"cx\", ctx_r1.centerX)(\"cy\", ctx_r1.centerY)(\"r\", ctx_r1.auToRadiusPx(r_r1));\n  }\n}\nfunction VoyagerMapComponent__svg_g_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"g\", 15);\n    i0.ɵɵlistener(\"click\", function VoyagerMapComponent__svg_g_12_Template_g_click_0_listener($event) {\n      const n_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      ctx_r1.openNode(n_r4);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵelement(1, \"circle\", 16);\n    i0.ɵɵelementStart(2, \"text\", 17);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const n_r4 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵclassProp(\"galaxy\", n_r4.kind === \"galaxy\");\n    i0.ɵɵattribute(\"cx\", n_r4.x)(\"cy\", n_r4.y);\n    i0.ɵɵadvance();\n    i0.ɵɵattribute(\"x\", n_r4.x + 8)(\"y\", n_r4.y + 4);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(n_r4.displayName);\n  }\n}\nfunction VoyagerMapComponent__svg_g_13__svg_g_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"g\", 15);\n    i0.ɵɵlistener(\"click\", function VoyagerMapComponent__svg_g_13__svg_g_1_Template_g_click_0_listener($event) {\n      const o_r7 = i0.ɵɵrestoreView(_r6).ngIf;\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      ctx_r1.openVoyager(o_r7);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵelement(1, \"line\", 24)(2, \"circle\", 25);\n    i0.ɵɵelementStart(3, \"text\", 26);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const o_r7 = ctx.ngIf;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵattribute(\"x1\", ctx_r1.centerX)(\"y1\", ctx_r1.centerY)(\"x2\", ctx_r1.voyagerX(o_r7))(\"y2\", ctx_r1.voyagerY(o_r7));\n    i0.ɵɵadvance();\n    i0.ɵɵattribute(\"cx\", ctx_r1.voyagerX(o_r7))(\"cy\", ctx_r1.voyagerY(o_r7));\n    i0.ɵɵadvance();\n    i0.ɵɵattribute(\"x\", ctx_r1.voyagerX(o_r7) + 10)(\"y\", ctx_r1.voyagerY(o_r7) - 8);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(o_r7.id === \"voyager2\" ? \"V2\" : \"V1\");\n  }\n}\nfunction VoyagerMapComponent__svg_g_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"g\", 18);\n    i0.ɵɵtemplate(1, VoyagerMapComponent__svg_g_13__svg_g_1_Template, 5, 9, \"g\", 19);\n    i0.ɵɵelement(2, \"line\", 20);\n    i0.ɵɵelementStart(3, \"circle\", 21);\n    i0.ɵɵlistener(\"click\", function VoyagerMapComponent__svg_g_13_Template_circle_click_3_listener($event) {\n      const a_r8 = i0.ɵɵrestoreView(_r5).ngIf;\n      const ctx_r1 = i0.ɵɵnextContext();\n      ctx_r1.openVoyager(a_r8);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"text\", 22);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"text\", 23);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const a_r8 = ctx.ngIf;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.other);\n    i0.ɵɵadvance();\n    i0.ɵɵattribute(\"x1\", ctx_r1.centerX)(\"y1\", ctx_r1.centerY)(\"x2\", ctx_r1.voyagerX(a_r8))(\"y2\", ctx_r1.voyagerY(a_r8));\n    i0.ɵɵadvance();\n    i0.ɵɵattribute(\"cx\", ctx_r1.voyagerX(a_r8))(\"cy\", ctx_r1.voyagerY(a_r8));\n    i0.ɵɵadvance();\n    i0.ɵɵattribute(\"x\", ctx_r1.voyagerX(a_r8) + 12)(\"y\", ctx_r1.voyagerY(a_r8) - 10);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r1.activeTitle);\n    i0.ɵɵadvance();\n    i0.ɵɵattribute(\"x\", ctx_r1.voyagerX(a_r8) + 12)(\"y\", ctx_r1.voyagerY(a_r8) + 10);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r1.formatDistanceLabelAu(a_r8.distanceFromSun == null ? null : a_r8.distanceFromSun.au));\n  }\n}\nfunction VoyagerMapComponent_div_14_ng_container_3_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 35)(1, \"div\", 36);\n    i0.ɵɵtext(2, \"Distance Terre\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 37);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"number\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const p_r11 = i0.ɵɵnextContext(2).ngIf;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind2(5, 1, p_r11.voyager.distanceFromEarth == null ? null : p_r11.voyager.distanceFromEarth.au, \"1.1-1\"), \" AU\");\n  }\n}\nfunction VoyagerMapComponent_div_14_ng_container_3_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 35)(1, \"div\", 36);\n    i0.ɵɵtext(2, \"Lon/Lat ecliptique\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 37);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"number\");\n    i0.ɵɵpipe(6, \"number\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const p_r11 = i0.ɵɵnextContext(2).ngIf;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate2(\" \", i0.ɵɵpipeBind2(5, 2, p_r11.voyager.trajectory == null ? null : p_r11.voyager.trajectory.eclipticLonDeg, \"1.0-1\"), \" deg / \", i0.ɵɵpipeBind2(6, 5, p_r11.voyager.trajectory == null ? null : p_r11.voyager.trajectory.eclipticLatDeg, \"1.0-1\"), \" deg \");\n  }\n}\nfunction VoyagerMapComponent_div_14_ng_container_3_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 35)(1, \"div\", 36);\n    i0.ɵɵtext(2, \"Cap vitesse (azimut)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 37);\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"number\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const p_r11 = i0.ɵɵnextContext(2).ngIf;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind2(5, 1, p_r11.voyager.trajectory == null ? null : p_r11.voyager.trajectory.velocityAzimuthDeg, \"1.0-0\"), \" deg\");\n  }\n}\nfunction VoyagerMapComponent_div_14_ng_container_3_div_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 41);\n    i0.ɵɵtext(1, \" Voyager reste dans la Voie lactee : la \\\"destination galaxie\\\" est un repere symbolique. Les valeurs proviennent de NASA JPL Horizons. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VoyagerMapComponent_div_14_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 30)(2, \"div\", 31);\n    i0.ɵɵtext(3, \"LIVE\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 32);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 33);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"div\", 34)(9, \"div\", 35)(10, \"div\", 36);\n    i0.ɵɵtext(11, \"Galaxie\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\", 37);\n    i0.ɵɵtext(13, \"Voie lactee\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"div\", 35)(15, \"div\", 36);\n    i0.ɵɵtext(16, \"Distance Soleil\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 37);\n    i0.ɵɵtext(18);\n    i0.ɵɵpipe(19, \"number\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(20, VoyagerMapComponent_div_14_ng_container_3_div_20_Template, 6, 4, \"div\", 38);\n    i0.ɵɵelementStart(21, \"div\", 35)(22, \"div\", 36);\n    i0.ɵɵtext(23, \"Vitesse\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"div\", 37);\n    i0.ɵɵtext(25);\n    i0.ɵɵpipe(26, \"number\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(27, VoyagerMapComponent_div_14_ng_container_3_div_27_Template, 7, 8, \"div\", 38)(28, VoyagerMapComponent_div_14_ng_container_3_div_28_Template, 6, 4, \"div\", 38);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"button\", 39);\n    i0.ɵɵlistener(\"click\", function VoyagerMapComponent_div_14_ng_container_3_Template_button_click_29_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.toggleExpanded());\n    });\n    i0.ɵɵtext(30);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(31, VoyagerMapComponent_div_14_ng_container_3_div_31_Template, 2, 0, \"div\", 40);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const p_r11 = i0.ɵɵnextContext().ngIf;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(p_r11.voyager.id === \"voyager2\" ? \"Voyager 2\" : \"Voyager 1\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.projectedTimestamp(p_r11.voyager));\n    i0.ɵɵadvance(11);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind2(19, 9, ctx_r1.projectedDistanceFromSunAu(p_r11.voyager), \"1.1-1\"), \" AU\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", (p_r11.voyager.distanceFromEarth == null ? null : p_r11.voyager.distanceFromEarth.au) !== undefined);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind2(26, 12, p_r11.voyager.speed == null ? null : p_r11.voyager.speed.kmPerS, \"1.2-2\"), \" km/s\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", (p_r11.voyager.trajectory == null ? null : p_r11.voyager.trajectory.eclipticLonDeg) !== undefined);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (p_r11.voyager.trajectory == null ? null : p_r11.voyager.trajectory.velocityAzimuthDeg) !== undefined);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.expanded ? \"Masquer details\" : \"Voir details\", \" \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.expanded);\n  }\n}\nfunction VoyagerMapComponent_div_14_ng_container_4_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 33);\n    i0.ɵɵtext(1, \"Hors echelle\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction VoyagerMapComponent_div_14_ng_container_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 30)(2, \"div\", 31);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 32);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(6, VoyagerMapComponent_div_14_ng_container_4_div_6_Template, 2, 0, \"div\", 42);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 41);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"button\", 39);\n    i0.ɵɵlistener(\"click\", function VoyagerMapComponent_div_14_ng_container_4_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.toggleExpanded());\n    });\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const p_r11 = i0.ɵɵnextContext().ngIf;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(p_r11.node.kind.toUpperCase());\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r11.node.displayName);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", p_r11.node.notToScale);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.expanded ? p_r11.node.long : p_r11.node.short, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.expanded ? \"Version courte\" : \"Version detaillee\", \" \");\n  }\n}\nfunction VoyagerMapComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 27)(1, \"button\", 28);\n    i0.ɵɵlistener(\"click\", function VoyagerMapComponent_div_14_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.closePanel());\n    });\n    i0.ɵɵtext(2, \"\\u00D7\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, VoyagerMapComponent_div_14_ng_container_3_Template, 32, 15, \"ng-container\", 29)(4, VoyagerMapComponent_div_14_ng_container_4_Template, 11, 5, \"ng-container\", 29);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const p_r11 = ctx.ngIf;\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", p_r11.kind === \"voyager\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", p_r11.kind === \"node\");\n  }\n}\nexport let VoyagerMapComponent = /*#__PURE__*/(() => {\n  class VoyagerMapComponent {\n    constructor(voyagerService, time) {\n      this.voyagerService = voyagerService;\n      this.time = time;\n      this.id = 'voyager1';\n      this.width = 800;\n      this.height = 800;\n      this.centerX = 400;\n      this.centerY = 400;\n      this.refreshIntervalMs = 60_000;\n      this.snapshot = null;\n      this.voyagers = [];\n      this.active = null;\n      this.other = null;\n      // Log scale max distance: ~4.75 ly (300k AU) keeps Voyager visible.\n      this.maxDistanceAu = 300_000;\n      this.offsetDays = 0;\n      this.selectedPanel = null;\n      this.expanded = false;\n      this.baseNodes = [{\n        id: 'kuiper',\n        kind: 'region',\n        displayName: 'Ceinture de Kuiper',\n        angleDeg: 210,\n        distanceAu: 45,\n        short: \"Zone d'objets transneptuniens (~30-50 UA).\",\n        long: 'Region au-dela de Neptune contenant de nombreux petits corps (objets transneptuniens).'\n      }, {\n        id: 'heliopause',\n        kind: 'region',\n        displayName: 'Heliopause',\n        angleDeg: 320,\n        distanceAu: 120,\n        short: 'Frontiere approximative du vent solaire (~120 UA).',\n        long: \"Zone ou l'influence du vent solaire s'equilibre avec le milieu interstellaire.\"\n      }, {\n        id: 'oort',\n        kind: 'region',\n        displayName: \"Nuage d'Oort\",\n        angleDeg: 30,\n        distanceAu: 50_000,\n        short: \"Reservoir theorique de cometes (jusqu'a ~100k UA).\",\n        long: 'Structure hypothetique tres lointaine, source possible de cometes a longue periode.'\n      }, {\n        id: 'proxima',\n        kind: 'star',\n        displayName: 'Proxima Centauri',\n        angleDeg: 120,\n        distanceAu: 268_000,\n        short: 'Etoile la plus proche (~4.24 a.l.).',\n        long: \"Naine rouge, membre du systeme Alpha Centauri. Distance indiquee a l'echelle radiale (ordre de grandeur).\"\n      }, {\n        id: 'alpha-centauri',\n        kind: 'star',\n        displayName: 'Alpha Centauri',\n        angleDeg: 150,\n        distanceAu: 276_000,\n        short: 'Systeme stellaire proche (~4.37 a.l.).',\n        long: \"Systeme binaire (A/B) + Proxima. Distance indiquee a l'echelle radiale (ordre de grandeur).\"\n      }, {\n        id: 'milky-way',\n        kind: 'galaxy',\n        displayName: 'Voie lactee',\n        angleDeg: 260,\n        notToScale: true,\n        short: 'Notre galaxie (contexte).',\n        long: 'Voyager 1 et 2 sont toujours dans la Voie lactee. Les galaxies sont affichees hors echelle.'\n      }, {\n        id: 'andromeda',\n        kind: 'galaxy',\n        displayName: 'Andromede',\n        angleDeg: 280,\n        notToScale: true,\n        short: 'Galaxie voisine (~2.5 M a.l., hors echelle).',\n        long: \"Destination symbolique uniquement : a ces vitesses, une traversee vers une autre galaxie depasserait de tres loin l'echelle humaine.\"\n      }];\n    }\n    ngOnInit() {\n      this.updateDimensionsFromWindow();\n      this.startPolling();\n      this.timeSub = this.time.offsetHours$.subscribe(h => {\n        this.offsetDays = h / 24;\n      });\n    }\n    ngOnDestroy() {\n      this.sub?.unsubscribe();\n      this.sub = undefined;\n      this.timeSub?.unsubscribe();\n      this.timeSub = undefined;\n    }\n    onResize() {\n      this.updateDimensionsFromWindow();\n    }\n    updateDimensionsFromWindow() {\n      this.width = Math.max(320, window.innerWidth);\n      this.height = Math.max(320, window.innerHeight);\n      this.centerX = this.width / 2;\n      this.centerY = this.height / 2;\n    }\n    startPolling() {\n      this.sub?.unsubscribe();\n      this.sub = interval(this.refreshIntervalMs).pipe(startWith(0), switchMap(() => this.voyagerService.getVoyagers())).subscribe({\n        next: snapshot => {\n          this.snapshot = snapshot;\n          this.voyagers = snapshot.voyagers ?? [];\n          this.pickActive();\n        },\n        error: () => {\n          // Garde la derniere valeur si l'API tombe.\n        }\n      });\n    }\n    pickActive() {\n      const wanted = this.id === 'voyager2' ? 'voyager2' : 'voyager1';\n      const v1 = this.voyagers.find(v => v.id === 'voyager1') ?? null;\n      const v2 = this.voyagers.find(v => v.id === 'voyager2') ?? null;\n      this.active = wanted === 'voyager1' ? v1 : v2;\n      this.other = wanted === 'voyager1' ? v2 : v1;\n    }\n    get ringsAu() {\n      return [1, 10, 100, 1_000, 10_000, 50_000, 100_000, 300_000];\n    }\n    auToRadiusPx(au) {\n      const maxRadiusPx = Math.min(this.width, this.height) / 2 - 70;\n      const d = Math.max(0, au);\n      const max = Math.max(1, this.maxDistanceAu);\n      const t = Math.log10(1 + d) / Math.log10(1 + max);\n      return t * maxRadiusPx;\n    }\n    voyagerX(v) {\n      const pos = this.projectedPositionAu(v);\n      const theta = Math.atan2(pos.y, pos.x);\n      const rAu = Math.sqrt(pos.x * pos.x + pos.y * pos.y + pos.z * pos.z) || 0;\n      const rPx = this.auToRadiusPx(rAu || 0);\n      return this.centerX + rPx * Math.cos(theta);\n    }\n    voyagerY(v) {\n      const pos = this.projectedPositionAu(v);\n      const theta = Math.atan2(pos.y, pos.x);\n      const rAu = Math.sqrt(pos.x * pos.x + pos.y * pos.y + pos.z * pos.z) || 0;\n      const rPx = this.auToRadiusPx(rAu || 0);\n      return this.centerY + rPx * Math.sin(theta);\n    }\n    projectedPositionAu(v) {\n      const x0 = v.positionAu?.x ?? 0;\n      const y0 = v.positionAu?.y ?? 0;\n      const z0 = v.positionAu?.z ?? 0;\n      const vx = v.velocityAuPerDay?.vx ?? 0;\n      const vy = v.velocityAuPerDay?.vy ?? 0;\n      const vz = v.velocityAuPerDay?.vz ?? 0;\n      return {\n        x: x0 + vx * this.offsetDays,\n        y: y0 + vy * this.offsetDays,\n        z: z0 + vz * this.offsetDays\n      };\n    }\n    projectedDistanceFromSunAu(v) {\n      const p = this.projectedPositionAu(v);\n      const r = Math.sqrt(p.x * p.x + p.y * p.y + p.z * p.z);\n      return Number.isFinite(r) ? r : null;\n    }\n    projectedTimestamp(v) {\n      const base = Date.parse(v.timestamp || '');\n      if (!Number.isFinite(base)) return v.timestamp;\n      return new Date(base + this.offsetDays * 86_400_000).toISOString();\n    }\n    get plottedNodes() {\n      const maxRadiusPx = Math.min(this.width, this.height) / 2 - 70;\n      return this.baseNodes.map(n => {\n        const angle = n.angleDeg * Math.PI / 180;\n        const rPx = n.distanceAu !== undefined ? this.auToRadiusPx(n.distanceAu) : maxRadiusPx * 0.92;\n        return {\n          ...n,\n          x: this.centerX + rPx * Math.cos(angle),\n          y: this.centerY + rPx * Math.sin(angle)\n        };\n      });\n    }\n    openVoyager(v) {\n      this.selectedPanel = {\n        kind: 'voyager',\n        voyager: v\n      };\n      this.expanded = false;\n    }\n    openNode(n) {\n      this.selectedPanel = {\n        kind: 'node',\n        node: n\n      };\n      this.expanded = false;\n    }\n    closePanel() {\n      this.selectedPanel = null;\n      this.expanded = false;\n    }\n    toggleExpanded() {\n      this.expanded = !this.expanded;\n    }\n    get activeTitle() {\n      return this.active?.id === 'voyager2' ? 'Voyager 2' : 'Voyager 1';\n    }\n    formatDistanceLabelAu(au) {\n      if (au === null || au === undefined || !Number.isFinite(au)) return '-';\n      if (au >= 100_000) return `${(au / 1000).toFixed(0)}k UA`;\n      if (au >= 1000) return `${au.toFixed(0)} UA`;\n      return `${au.toFixed(1)} UA`;\n    }\n    static {\n      this.ɵfac = function VoyagerMapComponent_Factory(t) {\n        return new (t || VoyagerMapComponent)(i0.ɵɵdirectiveInject(i1.VoyagerService), i0.ɵɵdirectiveInject(i2.TimeScrubberService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: VoyagerMapComponent,\n        selectors: [[\"app-voyager-map\"]],\n        hostBindings: function VoyagerMapComponent_HostBindings(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵlistener(\"resize\", function VoyagerMapComponent_resize_HostBindingHandler() {\n              return ctx.onResize();\n            }, false, i0.ɵɵresolveWindow);\n          }\n        },\n        inputs: {\n          id: \"id\"\n        },\n        decls: 15,\n        vars: 11,\n        consts: [[1, \"universe\"], [\"role\", \"img\", \"aria-label\", \"Voyager map\", 1, \"universe-svg\"], [\"id\", \"sunGlow\"], [\"offset\", \"0%\", \"stop-color\", \"#fff7c2\", \"stop-opacity\", \"1\"], [\"offset\", \"55%\", \"stop-color\", \"#ffcc33\", \"stop-opacity\", \"0.9\"], [\"offset\", \"100%\", \"stop-color\", \"#dd8800\", \"stop-opacity\", \"0.0\"], [\"aria-label\", \"Scale\", 1, \"rings\"], [\"class\", \"ring\", 4, \"ngFor\", \"ngForOf\"], [\"r\", \"10\", \"fill\", \"url(#sunGlow)\", 1, \"sun\"], [\"r\", \"3.8\", \"fill\", \"#ffcc33\", 1, \"sun-core\"], [1, \"context\"], [3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"voyagers\", 4, \"ngIf\"], [\"class\", \"panel\", \"role\", \"dialog\", \"aria-modal\", \"true\", 4, \"ngIf\"], [1, \"ring\"], [3, \"click\"], [\"r\", \"3.2\", 1, \"ctx-dot\"], [1, \"ctx-label\"], [1, \"voyagers\"], [3, \"click\", 4, \"ngIf\"], [1, \"ray\"], [\"r\", \"5.6\", 1, \"probe\", 3, \"click\"], [1, \"probe-label\"], [1, \"probe-sub\"], [1, \"ray\", \"ghost\"], [\"r\", \"4.2\", 1, \"probe\", \"ghost\"], [1, \"probe-label\", \"ghost\"], [\"role\", \"dialog\", \"aria-modal\", \"true\", 1, \"panel\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"close\", 3, \"click\"], [4, \"ngIf\"], [1, \"panel-hdr\"], [1, \"tag\"], [1, \"title\"], [1, \"sub\"], [1, \"rows\"], [1, \"row\"], [1, \"k\"], [1, \"v\"], [\"class\", \"row\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"expand\", 3, \"click\"], [\"class\", \"details\", 4, \"ngIf\"], [1, \"details\"], [\"class\", \"sub\", 4, \"ngIf\"]],\n        template: function VoyagerMapComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0);\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(1, \"svg\", 1)(2, \"defs\")(3, \"radialGradient\", 2);\n            i0.ɵɵelement(4, \"stop\", 3)(5, \"stop\", 4)(6, \"stop\", 5);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(7, \"g\", 6);\n            i0.ɵɵtemplate(8, VoyagerMapComponent__svg_circle_8_Template, 1, 3, \"circle\", 7);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(9, \"circle\", 8)(10, \"circle\", 9);\n            i0.ɵɵelementStart(11, \"g\", 10);\n            i0.ɵɵtemplate(12, VoyagerMapComponent__svg_g_12_Template, 4, 7, \"g\", 11);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(13, VoyagerMapComponent__svg_g_13_Template, 8, 13, \"g\", 12);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(14, VoyagerMapComponent_div_14_Template, 5, 2, \"div\", 13);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance();\n            i0.ɵɵattribute(\"width\", ctx.width)(\"height\", ctx.height)(\"viewBox\", \"0 0 \" + ctx.width + \" \" + ctx.height);\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"ngForOf\", ctx.ringsAu);\n            i0.ɵɵadvance();\n            i0.ɵɵattribute(\"cx\", ctx.centerX)(\"cy\", ctx.centerY);\n            i0.ɵɵadvance();\n            i0.ɵɵattribute(\"cx\", ctx.centerX)(\"cy\", ctx.centerY);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngForOf\", ctx.plottedNodes);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.active);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.selectedPanel);\n          }\n        },\n        dependencies: [i3.NgForOf, i3.NgIf, i3.DecimalPipe],\n        styles: [\"[_nghost-%COMP%]{display:block;width:100vw;height:100vh;overflow:hidden;background:radial-gradient(circle at 50% 40%,#060a22,#03040c 45%,#000)}.universe[_ngcontent-%COMP%]{position:relative;width:100%;height:100%}.universe[_ngcontent-%COMP%]:before{content:\\\"\\\";position:absolute;inset:0;pointer-events:none;background:radial-gradient(circle at 20% 30%,rgba(88,101,242,.08),transparent 45%),radial-gradient(circle at 70% 60%,rgba(0,255,240,.05),transparent 42%),radial-gradient(circle at 40% 80%,rgba(255,0,128,.04),transparent 50%),radial-gradient(circle at 12% 18%,rgba(255,255,255,.22) 0 1px,transparent 2px),radial-gradient(circle at 33% 72%,rgba(255,255,255,.18) 0 1px,transparent 2px),radial-gradient(circle at 82% 35%,rgba(255,255,255,.16) 0 1px,transparent 2px);filter:blur(.2px);opacity:.95}.universe-svg[_ngcontent-%COMP%]{width:100%;height:100%;display:block;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.rings[_ngcontent-%COMP%]{pointer-events:none}.ring[_ngcontent-%COMP%]{fill:none;stroke:#00fff01a;stroke-width:1;stroke-dasharray:2 7}.sun[_ngcontent-%COMP%]{filter:drop-shadow(0 0 18px rgba(255,204,51,.7))}.sun-core[_ngcontent-%COMP%]{filter:drop-shadow(0 0 10px rgba(255,204,51,.8))}.context[_ngcontent-%COMP%]{cursor:pointer}.ctx-dot[_ngcontent-%COMP%]{fill:#00fff0d9;filter:drop-shadow(0 0 8px rgba(0,255,240,.35))}.ctx-dot.galaxy[_ngcontent-%COMP%]{fill:#ff0080bf;filter:drop-shadow(0 0 10px rgba(255,0,128,.35))}.ctx-label[_ngcontent-%COMP%]{fill:#eef2ffc7;font-size:11px;font-weight:700;letter-spacing:.04em;paint-order:stroke;stroke:#000000bf;stroke-width:3px}.ray[_ngcontent-%COMP%]{stroke:#00fff061;stroke-width:1.4;filter:drop-shadow(0 0 10px rgba(0,255,240,.25))}.probe[_ngcontent-%COMP%]{fill:#00fff0eb;stroke:#fffc;stroke-width:1;filter:drop-shadow(0 0 14px rgba(0,255,240,.45));cursor:pointer}.probe-label[_ngcontent-%COMP%]{fill:#eef2ffeb;font-size:12px;font-weight:900;letter-spacing:.08em;text-transform:uppercase;paint-order:stroke;stroke:#000000d9;stroke-width:3px}.probe-sub[_ngcontent-%COMP%]{fill:#eef2ffad;font-size:11px;font-weight:700;paint-order:stroke;stroke:#000000d9;stroke-width:3px}.ghost[_ngcontent-%COMP%]{opacity:.35}.panel[_ngcontent-%COMP%]{position:absolute;right:18px;bottom:18px;width:min(420px,calc(100vw - 36px));padding:14px 14px 12px;border-radius:14px;background:#060a1ab8;backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,.08);box-shadow:0 18px 60px #000000bf;color:#eef2ffeb}.close[_ngcontent-%COMP%]{position:absolute;top:8px;right:10px;width:34px;height:34px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:#ffffff0a;color:#eef2ffeb;font-size:18px;cursor:pointer}.panel-hdr[_ngcontent-%COMP%]{padding-right:44px}.tag[_ngcontent-%COMP%]{display:inline-flex;padding:2px 8px;border-radius:999px;background:#00fff01f;border:1px solid rgba(0,255,240,.22);font-weight:900;letter-spacing:.14em;font-size:11px;width:-moz-fit-content;width:fit-content}.title[_ngcontent-%COMP%]{margin-top:8px;font-size:16px;font-weight:900;letter-spacing:.06em;text-transform:uppercase}.sub[_ngcontent-%COMP%]{margin-top:6px;font-size:12px;color:#eef2ffa6}.rows[_ngcontent-%COMP%]{margin-top:10px;border-top:1px solid rgba(255,255,255,.06)}.row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:12px;padding:8px 0;border-bottom:1px solid rgba(255,255,255,.04);font-size:12.5px}.k[_ngcontent-%COMP%]{color:#eef2ffb8}.v[_ngcontent-%COMP%]{font-weight:700}.expand[_ngcontent-%COMP%]{margin-top:10px;width:100%;padding:8px 10px;border-radius:12px;border:1px solid rgba(0,255,240,.2);background:#00fff00f;color:#eef2ffeb;font-weight:800;letter-spacing:.06em;cursor:pointer}.details[_ngcontent-%COMP%]{margin-top:10px;color:#eef2ffb8;font-size:12.5px;line-height:1.5}\"]\n      });\n    }\n  }\n  return VoyagerMapComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}